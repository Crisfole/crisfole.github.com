<!DOCTYPE html>

<form>
  <input id=camera type=file accept=image/* capture=environment>
  <label>Supported Formats: <strong id=formats></strong></label>
  <hr />
  <textarea id=result-out></textarea>
  <textarea id=error-out></textarea>
</form>
  <script>
    const barcodeDetector = new BarcodeDetector();

    const formats = document.getElementById('formats');
    BarcodeDetector.getSupportedFormats().then(fmts => {
      formats.textContent = fmts.join(", ");
    });

    const out = document.getElementById('result-out');
    const err = document.getElementById('error-out');
    document.getElementById('camera').addEventListener('input', evt => {
      const file = evt.target.files[0];
      barcodeDetector.detect(file)
        .then(x => {
          out.value = x.join("\n");
        })
      .catch(err => {
        err.value = err.toString();
      });
    });
  </script>
