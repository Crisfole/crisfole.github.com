<!DOCTYPE html>

<form>
  <input id=camera type=file accept=image/* capture=environment>
  <label>Format: <select id=formats></select></label>
  <hr />
  <label>Results</label>
  <div id=result-out></div>
  <label>Errors</label>
  <div id=error-out></div>
</form>
  <script>
    const formats = document.getElementById('formats');
    BarcodeDetector.getSupportedFormats().then(fmts => {
      formats.innerHTML = fmts.map(fmt => `<option>${fmt}</option>`).join("");
    });

    const out = document.getElementById('result-out');
    const err = document.getElementById('error-out');
    document.getElementById('camera').addEventListener('input', evt => {
      const file = evt.target.files[0];
      debugger;
      new BarcodeDetector({ formats: [ formats.value ] }).detect(file)
        .then(x => {
          out.textContent = x.join("\n");
        })
      .catch(err => {
        err.textContent = err.toString();
      });
    });
  </script>
